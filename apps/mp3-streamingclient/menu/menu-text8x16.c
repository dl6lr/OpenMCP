/*
   Font renderer
    Copyright (C) 2004-2010  by Malte Marwedel and others.
    m DOT talk AT marwedels DOT de

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
*/

/* This function writes single characters on a display.
The font size is 5x8 pixel, but only 5x7 pixel are drawn.
Every char needs 5 bytes of memory.

The 5x7 font is based on a modified font from:
http://overcode.yak.net/12

Date of last changes:
  2010-11-01: Minor optimizations, replace the font by freemono unless
              a better one is found or its clear that the font from
              lcd-module.de can be used.
  2010-09-20: Add large fonts. Font 4=compact 8x15, 5=fixed 8x15, 6=compact
              8x15 underline, 5=fixed 8x15 underline. Known Bug: Compact
              font problems with letter 'u', 'U', 'ü', 'Ü'. Font is copyright
              protected (http://www.lcd-module.de/)
  2010-05-15: Prevent overflow of chars to the left side
  2010-02-10: Add german umlauts, fix & and ~ sign, translate some comments
  2009-09-10: Use SCREENPOS datatype to support 16 bit screen resolution
  2009-05-24: Changed in black/white char renderer
  2005-07-19: Buchstabe "P" war falsch
  2005-07-23: draw_tinynumber(), draw_tinydigit() hinzugefuegt

*/

#include "menu-interpreter.h"
#include <string.h>

//make pc compatible
#ifndef AVR_BUILD
  #define PROGMEM
  #define memcpy_P memcpy
#else
  #include <avr/pgmspace.h>
#endif

//comment out to get the old behaviour (saves code + cpu time)
#define ENABLE_GERMAN_UMLAUTS

#ifdef ENABLE_GERMAN_UMLAUTS
#define MENU_CHARACTERS 102
#else
#define MENU_CHARACTERS 95
#endif

const char characters[] PROGMEM = {
0x00,0x00,0x00,0x00,0x00, //Space
0x00,0x00,0x5F,0x00,0x00, //Ausrufezeichen
0x00,0x03,0x00,0x03,0x00,
0x14,0x7F,0x14,0x7F,0x14,
0x24,0x2A,0x7F,0x2A,0x12,
0x26,0x16,0x08,0x34,0x32,
0x36,0x49,0x55,0x22,0x50, //&
0x00,0x00,0x03,0x00,0x00,
0x00,0x1C,0x22,0x41,0x00,
0x00,0x41,0x22,0x1C,0x00,
0x22,0x14,0x7F,0x14,0x22,
0x08,0x08,0x3E,0x08,0x08,
0x00,0x00,0x60,0x30,0x00,
0x08,0x08,0x08,0x08,0x08,
0x00,0x00,0x60,0x60,0x00,
0x20,0x10,0x08,0x04,0x02,
0x3E,0x41,0x41,0x41,0x3E,
0x00,0x42,0x7F,0x40,0x00,
0x42,0x61,0x51,0x49,0x46,
0x22,0x41,0x49,0x49,0x36,
0x0C,0x0A,0x49,0x7F,0x48,
0x2F,0x49,0x49,0x49,0x31,
0x3E,0x49,0x49,0x49,0x32,
0x01,0x71,0x09,0x05,0x03,
0x36,0x49,0x49,0x49,0x36,
0x26,0x49,0x49,0x49,0x3E,
0x00,0x00,0x36,0x36,0x00,
0x00,0x00,0x56,0x36,0x00,
0x08,0x14,0x22,0x41,0x00,
0x14,0x14,0x14,0x14,0x14,
0x41,0x22,0x14,0x08,0x00,
0x02,0x01,0x51,0x09,0x06,
0x3E,0x41,0x5D,0x55,0x1E,
0x7E,0x09,0x09,0x09,0x7E, //A
0x7F,0x49,0x49,0x49,0x36,
0x3E,0x41,0x41,0x41,0x22,
0x7F,0x41,0x41,0x41,0x3E,
0x7F,0x49,0x49,0x49,0x41,
0x7F,0x09,0x09,0x09,0x09, //F
0x3E,0x41,0x49,0x49,0x3A,
0x7F,0x08,0x08,0x08,0x7F, //H
0x00,0x41,0x7F,0x41,0x00, //I
0x30,0x40,0x41,0x3F,0x01,
0x7F,0x08,0x08,0x14,0x63,
0x00,0x7F,0x40,0x40,0x40,
0x7F,0x04,0x08,0x04,0x7F,
0x7F,0x02,0x0C,0x10,0x7F,
0x3E,0x41,0x41,0x41,0x3E,
0x7F,0x09,0x09,0x09,0x06, //P
0x3E,0x41,0x51,0x61,0x7E,
0x7F,0x09,0x19,0x29,0x46,
0x26,0x49,0x49,0x49,0x32,
0x01,0x01,0x7F,0x01,0x01,
0x3F,0x40,0x40,0x40,0x3F,
0x07,0x18,0x60,0x18,0x07,
0x1F,0x60,0x18,0x60,0x1F,
0x63,0x14,0x08,0x14,0x63,
0x03,0x04,0x78,0x04,0x03,
0x61,0x51,0x49,0x45,0x43,
0x00,0x7F,0x41,0x41,0x00,
0x02,0x04,0x08,0x10,0x20,
0x00,0x41,0x41,0x7F,0x00,
0x04,0x02,0x01,0x02,0x04,
0x40,0x40,0x40,0x40,0x40,
0x00,0x01,0x02,0x00,0x00,
0x30,0x4A,0x4A,0x4A,0x7C,
0x00,0x7F,0x44,0x44,0x38,
0x38,0x44,0x44,0x44,0x00,
0x00,0x38,0x44,0x44,0x7F,
0x38,0x54,0x54,0x54,0x18,
0x08,0x7E,0x09,0x01,0x00,
0x0C,0x52,0x52,0x52,0x3C,
0x7F,0x04,0x04,0x04,0x78,
0x00,0x00,0x7A,0x00,0x00,
0x20,0x40,0x3A,0x00,0x00,
0x7F,0x10,0x28,0x44,0x00,
0x00,0x00,0x7F,0x00,0x00,
0x7C,0x04,0x18,0x04,0x78,
0x00,0x78,0x04,0x04,0x78,
0x38,0x44,0x44,0x44,0x38,
0x7C,0x14,0x24,0x24,0x18,
0x18,0x24,0x24,0x14,0x7C,
0x7C,0x08,0x04,0x04,0x00,
0x48,0x54,0x54,0x54,0x24,
0x00,0x02,0x3F,0x42,0x00,
0x3C,0x40,0x40,0x40,0x3C,
0x1C,0x20,0x40,0x20,0x1C,
0x3C,0x40,0x30,0x40,0x3C,
0x44,0x28,0x10,0x28,0x44,
0x0C,0x50,0x50,0x50,0x3C,
0x44,0x64,0x54,0x4C,0x00,
0x08,0x36,0x41,0x41,0x00,
0x00,0x00,0x7F,0x00,0x00,
0x41,0x41,0x36,0x08,0x00,
0x08,0x04,0x08,0x10,0x08 //~
#ifdef ENABLE_GERMAN_UMLAUTS
,0x79,0x14,0x12,0x14,0x79, //A with dots
0x39,0x44,0x44,0x44,0x39, //O with dots
0x3D,0x40,0x40,0x40,0x3D, //U with dots
0x31,0x48,0x48,0x48,0x7D, //a with dots (o and u with dots are the same on a 5x7 font)
0x7E,0x01,0x49,0x49,0x36, //sz (spoken as 'sharp s')
0x00,0x00,0x00,0x00,0x00, // compatibility with large font german umlaute
0x00,0x00,0x00,0x00,0x00, // compatibility with large font german umlaute
#endif
};

/*Converted freemono font. See the license of the font under which terms it can be used.
The example here looks ughly. Use the converter utility to generate a better looking one.
*/

const char characters_8x16[] PROGMEM = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xBF, 0x9F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x0F, 0x00, 0x01, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x24, 0xFF, 0x2F, 0xFC, 0x7F, 0x24, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00,
0x00, 0xE4, 0x4E, 0xCB, 0xDB, 0x76, 0x30, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00,
0x00, 0x16, 0x19, 0xF9, 0x8E, 0xA8, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xE0, 0x9E, 0xB2, 0xE6, 0xF2, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x30, 0xFE, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x00, 0x00,
0x00, 0x00, 0x87, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x04, 0x14, 0x0F, 0x1F, 0x14, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x10, 0x10, 0xFE, 0xFE, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x80, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0xC0, 0x70, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x7E, 0xC3, 0x81, 0x81, 0xFF, 0x3C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x82, 0x83, 0xFF, 0xFF, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xC2, 0xE3, 0xB1, 0x99, 0xCF, 0xC4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xC2, 0x81, 0x89, 0x89, 0xDF, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x30, 0x38, 0xA6, 0xA3, 0xFF, 0xA0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xC0, 0x8F, 0x89, 0x89, 0xD9, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x38, 0xFE, 0x9B, 0x89, 0xD9, 0x71, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x03, 0x01, 0xC1, 0x79, 0x1F, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x66, 0xDF, 0x99, 0x99, 0xFF, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x84, 0x9F, 0x91, 0xD1, 0x6B, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x8C, 0x8C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x80, 0xCC, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x10, 0x18, 0x38, 0x2C, 0x44, 0x46, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x44, 0x64, 0x28, 0x38, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x06, 0x07, 0xB3, 0x93, 0x1E, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xFC, 0x03, 0x71, 0x49, 0x7E, 0x40, 0x00, 0x00, 0x00, 0x03, 0x02, 0x02, 0x03, 0x00, 0x00,
0x80, 0xF3, 0xBF, 0x27, 0x2F, 0xB8, 0xE0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xFF, 0xFF, 0x93, 0x9B, 0x9A, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x38, 0x7E, 0xC2, 0x83, 0x83, 0x82, 0xC7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xFF, 0x83, 0x83, 0x83, 0xC6, 0x7C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xFF, 0xFF, 0x93, 0xBB, 0x83, 0xE7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xFF, 0xFF, 0x93, 0xBB, 0x03, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x38, 0x7E, 0xC2, 0x83, 0xB3, 0xB3, 0xF7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0xFF, 0xFF, 0x90, 0x92, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x83, 0x83, 0xFF, 0xFF, 0x83, 0x82, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xF0, 0x80, 0x83, 0x83, 0xFF, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xFF, 0xFF, 0x9A, 0x3C, 0xE7, 0x83, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0x83, 0xFF, 0x83, 0x83, 0x80, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x83, 0xFF, 0x8E, 0x38, 0x38, 0x8E, 0xFF, 0x83, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x83, 0xFF, 0x86, 0x9C, 0x32, 0xE3, 0xFF, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x38, 0x7E, 0xC2, 0x83, 0x83, 0xC2, 0x7E, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xFF, 0xFF, 0x93, 0x93, 0x1E, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x38, 0x7E, 0xC2, 0x83, 0x83, 0xC2, 0x7E, 0x10, 0x00, 0x00, 0x03, 0x03, 0x03, 0x02, 0x03, 0x00,
0x82, 0xFF, 0xFF, 0x93, 0x33, 0x7E, 0xCC, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xEE, 0x9A, 0x9B, 0x93, 0xD6, 0x67, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x0F, 0x83, 0xFF, 0xFF, 0x83, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x03, 0x7F, 0xC3, 0x80, 0x82, 0xC3, 0x7F, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x03, 0x0F, 0x3B, 0xE0, 0xE0, 0x3F, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x03, 0xFF, 0xE3, 0x3C, 0x3C, 0xE3, 0xFF, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x82, 0xC3, 0xE7, 0x38, 0x3C, 0xE7, 0xC3, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x02, 0x03, 0x8F, 0xF8, 0xF8, 0x87, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xC7, 0xE7, 0xBB, 0x8F, 0x87, 0xE3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xFF, 0xFF, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x02, 0x00, 0x00,
0x00, 0x01, 0x07, 0x1C, 0x70, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00,
0x00, 0x00, 0x01, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x03, 0x03, 0x00, 0x00, 0x00,
0x00, 0x0C, 0x06, 0x03, 0x03, 0x06, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xE8, 0xBC, 0x94, 0xBC, 0xF8, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x81, 0xFF, 0xC8, 0x8C, 0x84, 0xCC, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x78, 0xCC, 0x8C, 0x8C, 0x8C, 0xDC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x30, 0x78, 0x8C, 0x84, 0x8C, 0xD9, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x30, 0x78, 0xAC, 0xA4, 0xAC, 0xA8, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x8C, 0x8C, 0xFF, 0x8D, 0x8D, 0x85, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x30, 0x78, 0x8C, 0x84, 0x8C, 0xFC, 0xFC, 0x04, 0x00, 0x00, 0x06, 0x06, 0x06, 0x03, 0x01, 0x00,
0x81, 0xFF, 0xFF, 0x0C, 0x84, 0xFC, 0xF0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x80, 0x8C, 0xFD, 0xFC, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x0C, 0x0C, 0x0D, 0xFD, 0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x06, 0x03, 0x00, 0x00,
0x81, 0xFF, 0xFF, 0x30, 0xEC, 0xCC, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x81, 0x81, 0xFF, 0xFF, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x8C, 0xFC, 0x8C, 0xFC, 0xF8, 0x04, 0xFC, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0xFC, 0xFC, 0x0C, 0x04, 0xFC, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x78, 0xCC, 0x8C, 0x8C, 0xC8, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x0C, 0xFC, 0x48, 0xCC, 0x84, 0xCC, 0x78, 0x00, 0x06, 0x07, 0x06, 0x06, 0x00, 0x00, 0x00, 0x00,
0x30, 0x78, 0xCC, 0x84, 0xCC, 0x48, 0xFC, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x06, 0x06, 0x07, 0x06,
0x00, 0x8C, 0xFC, 0xFC, 0x88, 0x8C, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xD8, 0x9C, 0xB4, 0xBC, 0xEC, 0x68, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x0C, 0x7E, 0xFF, 0x8C, 0x8C, 0x8C, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x0C, 0x7C, 0xFC, 0x80, 0x8C, 0xFC, 0xFC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x0C, 0x1C, 0x7C, 0xC0, 0xE0, 0x3C, 0x0C, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x0C, 0x7C, 0xEC, 0x70, 0x70, 0xEC, 0x3C, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0xCC, 0xFC, 0x30, 0xB0, 0xDC, 0xCC, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x04, 0x1C, 0x7C, 0xC0, 0xE0, 0x3C, 0x0C, 0x00, 0x04, 0x06, 0x06, 0x07, 0x06, 0x00, 0x00, 0x00,
0x00, 0x8C, 0xCC, 0xAC, 0x9C, 0xCC, 0xC4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x10, 0xFE, 0xCF, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x02, 0x00, 0x00,
0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00,
0x00, 0x00, 0x01, 0xFF, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x03, 0x01, 0x00, 0x00, 0x00,
0x00, 0x10, 0x08, 0x18, 0x30, 0x30, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
#ifdef ENABLE_GERMAN_UMLAUTS
0x80, 0xF3, 0xBF, 0x27, 0x2F, 0xB8, 0xE0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x38, 0x7E, 0xC2, 0x83, 0x83, 0xC2, 0x7E, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x03, 0x7F, 0xC3, 0x80, 0x82, 0xC3, 0x7F, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xE8, 0xBD, 0x94, 0xBD, 0xF9, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0xFE, 0xFF, 0x49, 0xCF, 0xDE, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x78, 0xCD, 0x8C, 0x8C, 0xC9, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x0C, 0x7C, 0xFD, 0x80, 0x8D, 0xFD, 0xFC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
#endif
};

unsigned char menu_font_heigth(unsigned char font) {
	if (font < 2)
		return 7; //normal 5x7 font
	else if (font < 4)
		return 8; //normal 5x7 font with underline
	else if (font < 6)
		return 15;//wide char 8x15 font
	return 16;    //wide char 8x15 font with underline
}

unsigned char menu_char_draw(SCREENPOS posx, SCREENPOS posy, unsigned char font, unsigned char cdraw) {
	unsigned char nunbyte, charwidth, nunbit;
	unsigned char copyedbytes[16];
	SCREENPOS tempx, tempy;
	unsigned char byte_eq_count,nun;
	unsigned char shrink;
	if ((font & 1)) {
		shrink = 0;
	} else
		shrink = 1;
	charwidth = 0;
#ifdef ENABLE_GERMAN_UMLAUTS
	if (cdraw == 196) cdraw = 127;  //Ä
	if (cdraw == 214) cdraw = 128;  //Ö
	if (cdraw == 220) cdraw = 129;  //Ü
	if (cdraw == 228) cdraw = 130;  //ä
	if (cdraw == 223) cdraw = 131;  //ß
	if (font < 4) {
		if (cdraw == 246) cdraw = 128;
		if (cdraw == 252) cdraw = 129;
	} else {
		if (cdraw == 246) cdraw = 132;  //ö
		if (cdraw == 252) cdraw = 133;  //ü
	}
#endif
	cdraw -= 32;
	if (cdraw < MENU_CHARACTERS) { //valid character
		if(font<4) {
			memcpy_P(copyedbytes,characters+cdraw*5, 5);
		} else {
			memcpy_P(copyedbytes,characters_8x16+cdraw*16, 16);
		}
		if(font<4){	//Normal 5x7 Font
		//automated shortening of chars, 5x7Font
			if (shrink != 0) {
				byte_eq_count = 0;
				for (nun = 0; nun < 4; nun++) {
					byte_eq_count++;
					if (copyedbytes[nun] != copyedbytes[nun+1]) {
						byte_eq_count = 0;
					}
					if (byte_eq_count == 2) {
						//remove one byte, if it repeated three times
						copyedbytes[nun] = 0;
					}
					if (byte_eq_count == 4) {
						//if there are 4 bytes equal, we remove a second one
						copyedbytes[nun] = 0;
					}
				} //end of loop
			} //end if shrink != 0
			for (nunbyte = 0; nunbyte < 5; nunbyte++) {
				tempx = posx+charwidth;
				if (tempx < posx+charwidth) {
					break; //prevent overflow to the left side of the screen
				}
				for (nunbit = 0; nunbit < 7;nunbit++) {
					tempy = posy+nunbit;
					if ((copyedbytes[nunbyte] & (0x01<<nunbit)) != 0) {
						menu_screen_set(tempx, tempy, 1);
					} else
						menu_screen_set(tempx, tempy, 0);
				}       //end: inner loop
				if (font & 2)
					menu_screen_set(tempx, posy+7, 1);
				if ((copyedbytes[nunbyte] != 0) || (shrink == 0)) {
					charwidth++;
				}       //end: charwidth++
			}         //end: outer loop
		} else { // Extended 8x16 font
			if (shrink != 0) {
				byte_eq_count = 0;
				for (nun = 0; nun < 7; nun++) {
					byte_eq_count++;
					if ((copyedbytes[nun] != copyedbytes[nun+1]) || (copyedbytes[nun+8] != copyedbytes[nun+9])) {
						byte_eq_count = 0;
					}
					if (byte_eq_count == 2) {
						//remove one byte, if it repeated three times
						copyedbytes[nun] = 0;
						copyedbytes[nun+8] = 0;
					}
					if (byte_eq_count == 4) {
						//if there are 4 patterns equal, we remove a second one
						copyedbytes[nun] = 0;
						copyedbytes[nun+8] = 0;
					}
				} //end of loop
			} //end if shrink != 0
			for (nunbyte = 0; nunbyte < 16; nunbyte++) {
				if (nunbyte == 8) {
					posy += 8;
					charwidth = 0;
				}
				tempx = posx+charwidth;
				if (tempx < posx+charwidth) {
					break; //prevent overflow to the left side of the screen
				}
				for (nunbit = 0; nunbit < 8; nunbit++) {
					tempy = posy+nunbit;
					if ((copyedbytes[nunbyte] & (0x01<<nunbit)) != 0) {
						menu_screen_set(tempx, tempy, 1);
					} else
						menu_screen_set(tempx, tempy, 0);
				}       //end: inner loop
				if ((font & 2) && (nunbyte > 7))    //Underliner
					menu_screen_set(tempx, posy+7, 1);
				if ((shrink == 0) || ((copyedbytes[nunbyte & 0x07] != 0) || (copyedbytes[(nunbyte & 0x07)+8] != 0))) {
					charwidth++;
				}
			}         //end: outer loop
		}
		if (font & 2) { //underline empty part between chars (this is not perfect on word ending)
			//printf("%i, %i\n", posx, charwidth);
			menu_screen_set(posx+charwidth, posy+7, 1);
		}
	}          //end: valid char
	return charwidth++;
}          //end: function
